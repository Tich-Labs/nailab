<%# app/views/mentor_portal/support/show.html.erb %>
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <div class="mb-8">
    <h1 class="text-4xl lg:text-5xl font-bold text-gray-900 mb-4">Support</h1>
    <p class="text-xl text-gray-600">Get help and support</p>
  </div>

  <!-- Existing Support Tickets -->
  <% if @support_tickets.any? %>
  <div class="bg-white rounded-xl shadow-lg overflow-hidden mb-8">
    <div class="bg-gradient-to-r from-teal-600 to-purple-600 px-8 py-6">
      <h3 class="text-2xl font-bold text-white">Your Support Tickets</h3>
    </div>
    <div class="p-8">
      <div class="space-y-4">
        <% @support_tickets.each do |ticket| %>
        <div class="border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow">
          <div class="flex justify-between items-start mb-4">
            <div class="flex-1">
              <h4 class="text-lg font-semibold text-gray-900 mb-2">
                <%= link_to ticket.subject, mentor_support_ticket_path(ticket), class: "text-purple-600 hover:text-purple-800" %>
              </h4>
              <p class="text-gray-600 text-sm mb-2"><%= ticket.description.truncate(100) %></p>
              <div class="flex items-center space-x-4 text-sm text-gray-500">
                <span>Category: <%= ticket.category %></span>
                <span>Created: <%= ticket.created_at.strftime('%b %d, %Y') %></span>
                <span>Last updated: <%= ticket.updated_at.strftime('%b %d, %Y') %></span>
              </div>
            </div>
            <div class="ml-4">
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                <% case ticket.status %>
                <% when 'open' %>bg-yellow-100 text-yellow-800
                <% when 'in_progress' %>bg-blue-100 text-blue-800
                <% when 'resolved' %>bg-green-100 text-green-800
                <% when 'closed' %>bg-gray-100 text-gray-800
                <% end %>">
                <%= ticket.status.humanize %>
              </span>
            </div>
          </div>
          <div class="flex justify-between items-center">
            <div class="text-sm text-gray-500">
              <%= ticket.replies.count %> message<%= 's' if ticket.replies.count != 1 %>
            </div>
            <%= link_to "View Conversation", mentor_support_ticket_path(ticket), class: "inline-flex items-center px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-lg hover:bg-purple-700 transition-colors" %>
          </div>
        </div>
        <% end %>
      </div>
    </div>
  </div>
  <% end %>

  <div class="bg-white rounded-xl shadow-lg overflow-hidden">
    <div class="bg-gradient-to-r from-purple-600 to-teal-600 px-8 py-6">
      <h3 class="text-2xl font-bold text-white">Submit a Support Ticket</h3>
    </div>
    <div class="p-8">
      <%= form_with url: mentor_support_tickets_path, scope: :support_ticket, local: true, class: "space-y-6" do |f| %>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <%= f.label :subject, class: "block text-sm font-semibold text-gray-900 mb-2" %>
            <%= f.text_field :subject, required: true, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" %>
          </div>
          <div>
            <%= f.label :category, class: "block text-sm font-semibold text-gray-900 mb-2" %>
            <%= f.select :category, ["Technical Issue", "Account Problem", "Billing Question", "Feature Request", "Other"], {}, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" %>
          </div>
        </div>

        <div>
          <%= f.label :description, class: "block text-sm font-semibold text-gray-900 mb-2" %>
          <%= f.text_area :description, required: true, rows: 6, placeholder: "Please describe your issue in detail...", class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" %>
        </div>

        <div class="flex justify-end">
          <%= f.submit "Submit Ticket", class: "inline-flex items-center px-8 py-4 bg-teal-600 text-white text-lg font-bold rounded-xl shadow-lg hover:bg-teal-700 transition-all" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
