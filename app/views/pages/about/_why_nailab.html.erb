<% about = AboutPage.first rescue nil %>
<% stored = {} %>
<% if about&.content.present? %>
  <% begin %>
    <% stored = JSON.parse(about.content) rescue {} %>
  <% rescue StandardError %>
    <% stored = {} %>
  <% end %>
<% end %>

<% section_key = 'why_nailab_exists' %>
<% section_data = stored[section_key] %>
<% image_url = nil %>
<% if about&.respond_to?(:why_nailab_image) && about.why_nailab_image.attached? %>
  <% begin %>
    <% image_url = url_for(about.why_nailab_image) %>
  <% rescue %>
    <% image_url = stored["#{section_key}_image_url"] %>
  <% end %>
<% else %>
  <% image_url = stored["#{section_key}_image_url"] %>
<% end %>

<% if section_data.is_a?(Hash) && (section_data['title'].present? || section_data['paragraph_one'].present? || image_url.present?) %>
  <section class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <div class="space-y-6">
          <h2 class="text-4xl lg:text-5xl font-bold text-gray-900"><%= section_data['title'] %></h2>
          <% if section_data['subheading'].present? %>
            <p class="text-lg text-gray-700 font-semibold"><%= section_data['subheading'] %></p>
          <% end %>
          <% if section_data['paragraph_one'].present? %>
            <p class="text-lg text-gray-700 leading-relaxed"><%= section_data['paragraph_one'] %></p>
          <% end %>
          <% if section_data['paragraph_two'].present? %>
            <p class="text-lg text-gray-700 leading-relaxed"><%= section_data['paragraph_two'] %></p>
          <% end %>
          <% if section_data['paragraph_three'].present? %>
            <p class="text-lg text-gray-700 leading-relaxed"><%= section_data['paragraph_three'] %></p>
          <% end %>
        </div>
        <div class="relative">
          <div class="relative rounded-2xl overflow-hidden shadow-xl">
            <% if image_url.present? %>
              <img src="<%= image_url %>" alt="Nailab team collaboration" class="w-full h-[500px] object-cover" />
            <% else %>
              <img src="https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=1200" alt="Nailab team collaboration" class="w-full h-[500px] object-cover" />
            <% end %>
          </div>
          <div class="absolute -bottom-4 -right-4 w-40 h-40 bg-purple-100 rounded-2xl -z-10"></div>
          <div class="absolute -top-4 -left-4 w-40 h-40 bg-teal-100 rounded-2xl -z-10"></div>
        </div>
      </div>
    </div>
  </section>
<% elsif stored[section_key].present? %>
  <%= raw stored[section_key] %>
<% else %>
  <section class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <div class="space-y-6">
          <h2 class="text-4xl lg:text-5xl font-bold text-gray-900">Why Nailab Exists</h2>
          <p class="text-lg text-gray-700 leading-relaxed">Limited access to capital and knowledge are among the biggest challenges African founders face when launching their startups. In Africa, Nailab is changing that narrative by lowering the barriers to entry for tech founders looking to start and scale their businesses.</p>
          <p class="text-lg text-gray-700 leading-relaxed">For over a decade, we have supported founders with the skills, mentorship, and funding they need to build scalable, impact-driven businesses that tackle Africa's most pressing challenges. Through strategic partnerships and tailored coaching programs, we create an enabling environment where startups can succeed â€” connecting them with investors, mentors, and key networks.</p>
          <p class="text-lg text-gray-700 leading-relaxed">At Nailab, we believe in the power of African-led solutions to transform industries and uplift communities.</p>
        </div>
        <div class="relative">
          <div class="relative rounded-2xl overflow-hidden shadow-xl">
            <% if image_url.present? %>
              <img src="<%= image_url %>" alt="Nailab team collaboration" class="w-full h-[500px] object-cover" />
            <% else %>
              <img src="https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=1200" alt="Nailab team collaboration" class="w-full h-[500px] object-cover" />
            <% end %>
          </div>
          <div class="absolute -bottom-4 -right-4 w-40 h-40 bg-purple-100 rounded-2xl -z-10"></div>
          <div class="absolute -top-4 -left-4 w-40 h-40 bg-teal-100 rounded-2xl -z-10"></div>
        </div>
      </div>
    </div>
  </section>
<% end %>