<%# app/views/mentor_onboarding/show.html.erb %>
<div class="min-h-screen bg-gray-50">
  <div class="max-w-4xl mx-auto px-4 py-8">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">Become a Nailab Mentor</h1>
      <p class="text-gray-600">Join our community of experienced mentors helping startups succeed</p>
    </div>
    <!-- Progress Bar -->
    <div class="mb-8">
      <div class="flex justify-between items-center mb-4">
        <span class="text-sm font-medium text-gray-700">Step <%= @step_index = MentorOnboardingController::STEPS.index(@step) + 1 %> of <%= MentorOnboardingController::STEPS.length %></span>
        <span class="text-sm text-gray-500"><%= @progress.round %>% complete</span>
      </div>
      <div class="w-full bg-gray-200 rounded-full h-2">
        <div class="bg-nailab-teal h-2 rounded-full transition-all duration-300" style="width: <%= @progress %>%"></div>
      </div>
    </div>
    <!-- Step Content -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
      <%= render "mentor_onboarding/steps/#{@step}" %>
    </div>
    <!-- Navigation -->
    <div class="flex justify-between mt-8">
      <% if @step_index > 1 %>
        <%= link_to mentor_onboarding_path(step: MentorOnboardingController::STEPS[@step_index - 2]),
                    class: "px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors" do %>
          <i class="fas fa-arrow-left mr-2"></i> Previous
        <% end %>
      <% else %>
        <div></div>
      <% end %>
      <div class="flex gap-4">
        <%= button_tag type: 'submit', form: 'mentor-onboarding-save-exit-form',
                       class: "px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors" do %>
          <i class="fas fa-save mr-2"></i> Save & Exit
        <% end %>
        <% if @step == 'review' %>
          <% unless current_user %>
            <div class="mt-8 p-6 bg-orange-50 rounded-lg text-center">
              <h3 class="text-xl font-bold mb-2 text-orange-700">Thank you for completing the onboarding form!</h3>
              <p class="mb-4 text-gray-700">To finish, please create an account. You will receive a confirmation email after registration.</p>
              <%= link_to 'Create Account', new_mentor_registration_path, class: 'btn btn-primary bg-orange-600 hover:bg-orange-700 text-white px-8 py-3 rounded-lg font-semibold shadow-lg' %>
            </div>
          <% end %>
          <%= button_tag type: 'submit', form: 'mentor-onboarding-form',
                         class: "px-6 py-3 bg-nailab-teal text-white rounded-lg hover:bg-nailab-teal transition-colors" do %>
            <i class="fas fa-check mr-2"></i> Complete Onboarding
          <% end %>
        <% else %>
          <%= button_tag type: 'submit', form: 'mentor-onboarding-form',
                         class: "px-6 py-3 bg-nailab-teal text-white rounded-lg hover:bg-nailab-teal transition-colors" do %>
            Save & Continue <i class="fas fa-arrow-right ml-2"></i>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
<!-- Hidden form for Save & Exit -->
<%= form_with url: mentor_onboarding_save_and_exit_path, method: :patch, id: 'mentor-onboarding-save-exit-form', local: true do |f| %>
  <%= hidden_field_tag :step, @step %>
  <%= fields_for 'user_profile', @profile do |profile_form| %>
    <!-- Include all current step fields for saving -->
    <% case @step %>
    <% when 'basic_details' %>
      <%= profile_form.hidden_field :full_name %>
      <%= profile_form.hidden_field :bio %>
      <%= profile_form.hidden_field :title %>
    <% when 'work_experience' %>
      <%= profile_form.hidden_field :organization %>
      <%= profile_form.hidden_field :years_experience %>
      <%= profile_form.hidden_field :advisory_experience %>
      <%= profile_form.hidden_field :advisory_description %>
    <% when 'mentorship_focus' %>
      <!-- Array fields need special handling -->
    <% when 'mentorship_style' %>
      <%= profile_form.hidden_field :mentorship_approach %>
      <%= profile_form.hidden_field :motivation %>
    <% when 'availability' %>
      <%= profile_form.hidden_field :availability_hours_month %>
      <%= profile_form.hidden_field :preferred_mentorship_mode %>
      <%= profile_form.hidden_field :rate_per_hour %>
      <%= profile_form.hidden_field :pro_bono %>
      <%= profile_form.hidden_field :linkedin_url %>
      <%= profile_form.hidden_field :professional_website %>
      <%= profile_form.hidden_field :currency %>
    <% end %>
  <% end %>
<% end %>