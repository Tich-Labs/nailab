<h1 class="text-2xl font-bold mb-4">Connect. Grow. Impact. â€” Editor & Preview</h1>

<div class="grid grid-cols-2 gap-8 mb-6">
    <div>
                <h2 class="font-semibold mb-3">Editor</h2>
                <div class="mb-4">
                    <%= link_to 'Preview live section', root_path(anchor: 'connect-grow-impact'), class: 'btn btn-secondary' %>
                </div>
                <div class="bg-white p-4 rounded shadow">
        <%= form_with url: admin_homepage_connect_grow_impact_update_path, method: :patch, local: true do %>
            <p class="text-sm text-slate-600 mb-4">Edit the intro and the three Connect. Grow. Impact. cards.</p>

            <div class="mb-4">
            <%= label_tag "connect[title]", 'Section title', class: 'block font-bold text-black' %>
            <%= text_field_tag "connect[title]", (@connect_title || 'Connect. Grow. Impact.'), class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
            </div>

            <div class="mb-4">
            <%= label_tag "connect[intro]", 'Intro copy', class: 'block font-bold text-black' %>
            <%= text_area_tag "connect[intro]", (@connect_intro || PagesController::DEFAULT_CONNECT_INTRO), class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2', rows: 3 %>
            </div>

            <% cards = @connect_cards || PagesController::DEFAULT_CONNECT_CARDS %>
            <% cards.each_with_index do |card, idx| %>
            <div class="mb-4 border rounded p-3">
                <p class="text-xs font-semibold mb-2">Card <%= idx + 1 %></p>
                <div class="mb-2">
                <%= label_tag "connect[cards][#{idx}][title]", 'Title', class: 'block font-bold text-black' %>
                <%= text_field_tag "connect[cards][#{idx}][title]", (card.is_a?(Hash) ? (card['title'] || card[:title]) : card[:title]), class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
                </div>
                <div class="mb-2">
                <%= label_tag "connect[cards][#{idx}][description]", 'Description', class: 'block font-bold text-black' %>
                <%= text_area_tag "connect[cards][#{idx}][description]", (card.is_a?(Hash) ? (card['description'] || card[:description]) : card[:description]), class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2', rows: 3 %>
                </div>
                <div class="grid grid-cols-2 gap-4">
                <div>
                    <%= label_tag "connect[cards][#{idx}][cta_label]", 'CTA label', class: 'block font-bold text-black' %>
                    <%= text_field_tag "connect[cards][#{idx}][cta_label]", (card.is_a?(Hash) ? (card['cta_label'] || card[:cta_label]) : card[:cta_label]), class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
                </div>
                <div>
                    <%= label_tag "connect[cards][#{idx}][cta_link]", 'CTA link', class: 'block font-bold text-black' %>
                    <%= text_field_tag "connect[cards][#{idx}][cta_link]", (card.is_a?(Hash) ? (card['cta_link'] || card[:cta_link]) : card[:cta_link]), class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
                </div>
                </div>
            </div>
            <% end %>

            <div class="flex gap-3">
            <%= submit_tag 'Save Connect cards', class: 'btn btn-primary' %>
            </div>
        <% end %>
        </div>
    </div>

    <div>
        <h2 class="font-semibold mt-2 mb-16">Preview</h2>
        <div class="bg-white p-6 rounded shadow space-y-5">
        <div class="text-center mb-4">
            <h3 class="text-2xl font-bold text-gray-900 mb-2"><%= @connect_title || 'Connect. Grow. Impact.' %></h3>
            <p class="text-sm text-slate-600 max-w-prose mx-auto"><%= @connect_intro || PagesController::DEFAULT_CONNECT_INTRO %></p>
        </div>

        <div class="grid grid-cols-1 gap-4">
            <% cards = @connect_cards || PagesController::DEFAULT_CONNECT_CARDS %>
            <% cards.each_with_index do |card, idx| %>
            <% title = card.is_a?(Hash) ? (card['title'] || card[:title]) : card.title %>
            <% desc = card.is_a?(Hash) ? (card['description'] || card[:description]) : card.description %>
            <% cta_label = card.is_a?(Hash) ? (card['cta_label'] || card[:cta_label]) : card.cta_label %>
            <% cta_link = card.is_a?(Hash) ? (card['cta_link'] || card[:cta_link]) : card.cta_link %>
            <div class="border rounded p-4">
                <h4 class="font-semibold mb-2"><%= title %></h4>
                <p class="text-sm text-slate-600 mb-3"><%= desc %></p>
                <% if cta_label.present? %>
                <a href="<%= cta_link.presence || '#' %>" class="text-purple-600 font-semibold"><%= cta_label %></a>
                <% end %>
            </div>
            <% end %>
        </div>
        </div>
    </div>
</div>
