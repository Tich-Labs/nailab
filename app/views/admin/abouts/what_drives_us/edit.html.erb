<h1 class="text-2xl font-bold mb-4">Edit: What Drives Us</h1>

<div class="grid grid-cols-2 gap-8 mb-6">
  <div>
    <h2 class="font-semibold mb-3">Editor</h2>
    <div class="mb-4">
      <%= link_to 'Preview live section', '/about#what-drives-us', class: 'btn btn-secondary', target: '_blank', rel: 'noopener' %>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <%= form_with url: admin_about_section_update_path(section: 'what_drives_us'), method: :patch, local: true do %>
        <p class="text-sm text-slate-600 mb-4">Edit the section title and each card's title and description.</p>
        <div class="mb-3">
          <%= label_tag "section[title]", 'Section Title', class: 'block font-bold text-black' %>
          <%= text_field_tag 'section_payload[title]', (@section_content && (@section_content['title'] || @section_content[:title])), class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
        </div>
        <h3 class="font-semibold mt-6 mb-2">Cards</h3>
        <% cards = (@section_content && (@section_content['cards'] || @section_content[:cards])) || [] %>
        <% 6.times do |i| %>
          <div class="p-4 bg-white rounded-lg shadow border border-gray-100 mb-4">
            <div class="mb-2">
              <%= label_tag "section_payload[cards][#{i}][title]", "Card Title", class: "block text-sm font-bold text-black" %>
              <%= text_field_tag "section_payload[cards][#{i}][title]", cards[i] && (cards[i]['title'] || cards[i][:title]), class: "w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2" %>
            </div>
              <div>
              <%= label_tag "section_payload[cards][#{i}][description]", "Card Description", class: "block text-sm font-bold text-black" %>
              <%= text_area_tag "section_payload[cards][#{i}][description]", cards[i] && (cards[i]['description'] || cards[i][:description]), class: "w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2", rows: 2 %>
            </div>
          </div>
        <% end %>
        <div class="flex gap-3 mt-6">
          <input type="submit" name="commit" value="Save" class="btn btn-success text-white font-bold" data-disable-with="Save">
        </div>
      <% end %>
    </div>
  </div>
  <div>
    <h2 class="font-semibold mt-2 mb-16">Preview</h2>
    <div class="bg-white p-6 rounded shadow space-y-5">
      <div class="space-y-4">
        <h2 class="text-2xl font-bold mb-8"><%= @section_content['title'] || @section_content[:title] || 'What Drives Us' %></h2>
        <div class="flex flex-col gap-8">
          <% cards = (@section_content['cards'] || @section_content[:cards]) || [] %>
          <% 6.times do |i| %>
            <% card = cards[i] || {} %>
            <div class="bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1">
              <h3 class="text-2xl font-bold text-gray-900 mb-4"><%= card['title'] || card[:title] %></h3>
              <p class="text-gray-700 leading-relaxed"><%= card['description'] || card[:description] %></p>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
