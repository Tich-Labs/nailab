<h2 class="font-semibold mb-3">Editor</h2>
    <div class="mb-4 text-left">
      <%= link_to 'Preview live section', about_path(anchor: 'why-nailab-exists'), class: 'btn btn-secondary', target: '_blank', rel: 'noopener' %>
    </div>
<div class="bg-white p-4 rounded shadow">
  <%= form_with url: admin_about_section_update_path(section: 'why_nailab_exists'), method: :patch, local: true, html: { multipart: true } do |form| %>
    <p class="text-sm text-slate-600 mb-4">Update the Why Nailab Exists section content.</p>
    <%# Support multiple stored shapes: description or paragraph_one/paragraph_two/paragraph_three.
        If description is absent, join paragraph_one..three with blank lines so editor shows full content. %>
    <div class="mb-3">
      <%= label_tag 'section_payload[title]', 'Title', class: 'block font-bold text-black' %>
      <%= text_field_tag 'section_payload[title]', (@section_content && (@section_content['title'] || @section_content[:title])), id: 'editor_why_title', class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
    </div>
    <div class="mb-3">
      <%= label_tag 'section_payload[description]', 'Description', class: 'block font-bold text-black' %>
      <%# Build a combined description: prefer explicit description, otherwise join paragraph_one..three with double newlines %>
      <% 
        combined_desc = if @section_content && (@section_content['description'].present? || @section_content[:description].present?)
          (@section_content['description'] || @section_content[:description]).to_s
        else
          parts = []
          parts << (@section_content['paragraph_one'] || @section_content[:paragraph_one]) if (@section_content && (@section_content['paragraph_one'] || @section_content[:paragraph_one])).present?
          parts << (@section_content['paragraph_two'] || @section_content[:paragraph_two]) if (@section_content && (@section_content['paragraph_two'] || @section_content[:paragraph_two])).present?
          parts << (@section_content['paragraph_three'] || @section_content[:paragraph_three]) if (@section_content && (@section_content['paragraph_three'] || @section_content[:paragraph_three])).present?
          parts.join("\n\n")
        end
      %>
      <%= text_area_tag 'section_payload[description]', combined_desc, id: 'editor_why_description', rows: 8, class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
    </div>

    <div class="mb-3">
      <p class="text-sm font-medium text-slate-700 mb-2">Image</p>
      <% if @section_image_url.present? %>
        <div class="mb-2">
          <img src="<%= @section_image_url %>" alt="Why Nailab Exists image" class="max-h-40 rounded border border-slate-200" />
        </div>
      <% end %>

      <div class="mb-2">
        <%= label_tag 'section_payload[image]', 'Upload image', class: 'block font-bold text-black' %>
        <%= file_field_tag 'section_payload[image]', accept: 'image/*', class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
      </div>

      <div>
        <%= label_tag 'section_payload[image_url]', 'Or image URL', class: 'block font-bold text-black' %>
        <%= text_field_tag 'section_payload[image_url]', @section_image_url, placeholder: 'https://...', class: 'w-full form-input admin-form-input bg-white border border-gray-200 shadow-sm rounded-md px-3 py-2' %>
        <p class="text-xs text-slate-500 mt-1">If you paste a URL, it will be used as the image source.</p>
      </div>
    </div>

    <div class="flex gap-3">
      <%= form.submit 'Save Why Nailab Exists', class: 'btn btn-success text-white font-bold' %>
    </div>
  <% end %>
</div>
